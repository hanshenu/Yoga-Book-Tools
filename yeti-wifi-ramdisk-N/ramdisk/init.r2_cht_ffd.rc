on post-fs-data
    mkdir /data/kpanic 0770 system system
    mkdir /data/kpanic/pstore 0770 system system
    # Set indication (checked by vold) that we have finished this action
    setprop vold.post_fs_data_done 1

on boot
    insmod ${ro.boot.moduleslocation}/ov8858_driver.ko
    insmod ${ro.boot.moduleslocation}/ov2740_driver.ko

# vibrator
    chown system system /sys/class/timed_output/vibrator_0/enable
    chmod 0664 /sys/class/timed_output/vibrator_0/enable
    restorecon /sys/class/timed_output/vibrator_0/enable
    chown system system /sys/class/timed_output/vibrator_1/enable
    chmod 0664 /sys/class/timed_output/vibrator_1/enable
    restorecon /sys/class/timed_output/vibrator_1/enable

#anypen
    chown system system /sys/bus/i2c/devices/5-006c/anypen
    chmod 0664 /sys/bus/i2c/devices/5-006c/anypen
    restorecon /sys/bus/i2c/devices/5-006c/anypen

# vibrator char dev
    chmod 0664 /dev/drv2604L_0
    chown system system /dev/drv2604L_0
    restorecon /dev/drv2604L_0
    chmod 0664 /dev/drv2604L_1
    chown system system /dev/drv2604L_1
    restorecon /dev/drv2604L_1

# touch raw data
    chmod 0666 /proc/gmnode
    chown system system /proc/gmnode
    restorecon /proc/gmnode

    # sar sensor
    chown system system /sys/bus/i2c/drivers/sx9310/1-0028/reg
    chmod 0664 /sys/bus/i2c/drivers/sx9310/1-0028/reg
    restorecon /sys/bus/i2c/drivers/sx9310/1-0028/reg
    chown radio system /sys/bus/i2c/drivers/sx9310/1-0028/calibrate
    chmod 0664 /sys/bus/i2c/drivers/sx9310/1-0028/calibrate
    restorecon /sys/bus/i2c/drivers/sx9310/1-0028/calibrate
    chown system system /sys/bus/i2c/drivers/sx9310/1-0028/status
    chmod 0664 /sys/bus/i2c/drivers/sx9310/1-0028/status
    restorecon /sys/bus/i2c/drivers/sx9310/1-0028/status
    chmod 0664 /sys/bus/i2c/drivers/sx9310/1-0028/enable
    restorecon /sys/bus/i2c/drivers/sx9310/1-0028/enable
    chown system system /sys/bus/i2c/drivers/sx9310/1-0028/sarconfig
    chmod 0664 /sys/bus/i2c/drivers/sx9310/1-0028/sarconfig
    restorecon /sys/bus/i2c/drivers/sx9310/1-0028/sarconfig
# vibrator
    chown system system /sys/class/timed_output/vibrator_0/enable
    chmod 0664 /sys/class/timed_output/vibrator_0/enable
    restorecon /sys/class/timed_output/vibrator_0/enable
    chown system system /sys/class/timed_output/vibrator_1/enable
    chmod 0664 /sys/class/timed_output/vibrator_1/enable
    restorecon /sys/class/timed_output/vibrator_1/enable

    # ish
    chmod 0664 /dev/ish
    chown system system /dev/ish
    restorecon /dev/ish

    # hall
    chown system system /sys/class/switch2/hall/state
    chmod 0664 /sys/class/switch2/hall/state
    restorecon /sys/class/switch2/hall/state
    chown system system /sys/class/switch2/sec_hall/state
    chmod 0664 /sys/class/switch2/sec_hall/state
    restorecon /sys/class/switch2/sec_hall/state

    # keyboard backlight
    chown system system /sys/class/leds/keyboard-led/brightness
    chmod 0664 /sys/class/leds/keyboard-led/brightness
    restorecon /sys/class/leds/keyboard-led/brightness
    # charger gp leds
    chown system system /sys/devices/platform/charger_gp_led.0/chr_enable
    chmod 0664 /sys/devices/platform/charger_gp_led.0/chr_enable
    restorecon /sys/devices/platform/charger_gp_led.0/chr_enable
    chown system system /sys/devices/platform/charger_gp_led.0/chr_freq
    chmod 0664 /sys/devices/platform/charger_gp_led.0/chr_freq
    restorecon /sys/devices/platform/charger_gp_led.0/chr_freq
    chown system system /sys/devices/platform/charger_gp_led.0/chr_effect
    chmod 0664 /sys/devices/platform/charger_gp_led.0/chr_effect
    restorecon /sys/devices/platform/charger_gp_led.0/chr_effect
    chown system system /sys/devices/platform/charger_gp_led.0/gp_enable
    chmod 0664 /sys/devices/platform/charger_gp_led.0/gp_enable
    restorecon /sys/devices/platform/charger_gp_led.0/gp_enable
    chown system system /sys/devices/platform/charger_gp_led.0/gp_freq
    chmod 0664 /sys/devices/platform/charger_gp_led.0/gp_freq
    restorecon /sys/devices/platform/charger_gp_led.0/gp_freq
    chown system system /sys/devices/platform/charger_gp_led.0/gp_effect
    chmod 0664 /sys/devices/platform/charger_gp_led.0/gp_effect
    restorecon /sys/devices/platform/charger_gp_led.0/gp_effect
# vibrator char dev
    chmod 0664 /dev/drv2604L_0
    chown system system /dev/drv2604L_0
    restorecon /dev/drv2604L_0
    chmod 0664 /dev/drv2604L_1
    chown system system /dev/drv2604L_1
    restorecon /dev/drv2604L_1
    # touch
    chown system system /sys/bus/i2c/devices/1-0014/line_gap
    chmod 0644 /sys/bus/i2c/devices/1-0014/line_gap
    restorecon /sys/bus/i2c/devices/1-0014/line_gap
    chown system system /sys/bus/i2c/devices/1-0014/tp_mode
    chmod 0644 /sys/bus/i2c/devices/1-0014/tp_mode
    restorecon /sys/bus/i2c/devices/1-0014/tp_mode
    chown system system /sys/bus/i2c/devices/1-0014/wake_switch
    chmod 0644 /sys/bus/i2c/devices/1-0014/wake_switch
    restorecon /sys/bus/i2c/devices/1-0014/wake_switch
    chown system system /sys/bus/i2c/devices/3-0044/tp_mode
    chmod 0644 /sys/bus/i2c/devices/3-0044/tp_mode
    restorecon /sys/bus/i2c/devices/3-0044/tp_mode
    chown system system /sys/bus/i2c/devices/3-0009/tp_mode
    chmod 0644 /sys/bus/i2c/devices/3-0009/tp_mode
    restorecon /sys/bus/i2c/devices/3-0009/tp_mode
    # lcd
    chown system system /dev/lcd0
    chmod 0666 /dev/lcd0

    #charging control kernel interface
    chown system system /sys/bus/i2c/drivers/bq2589x/14-006b/charge_en_ctrl
    chmod 0666 /sys/bus/i2c/drivers/bq2589x/14-006b/charge_en_ctrl
    restorecon /sys/bus/i2c/drivers/bq2589x/14-006b/charge_en_ctrl
    chown system system /sys/devices/i2c-14/14-006b/charge_en_ctrl
    chmod 0666 /sys/devices/i2c-14/14-006b/charge_en_ctrl
    restorecon /sys/devices/i2c-14/14-006b/charge_en_ctrl

#sar sensor
service sar_config /system/bin/sh /system/bin/sar_config.sh
    user root
    class late_start
    oneshot
    seclabel u:r:sar_config:s0
on init
    symlink /fstab /fstab.r2_cht_ffd

    # qtaguid will limit access to specific data based on group memberships.
    #   net_bw_acct grants impersonation of socket owners.
    #   net_bw_stats grants access to other apps' detailed tagged-socket stats.
    chown root net_bw_acct /proc/net/xt_qtaguid/ctrl
    chown root net_bw_stats /proc/net/xt_qtaguid/stats

    # Allow everybody to read the xt_qtaguid resource tracking misc dev.
    # This is needed by any process that uses socket tagging.
    chmod 0644 /dev/xt_qtaguid
    mkdir /country 0777 system system

on post-fs
    #Accelerometer: X & Z inverted
    setprop ro.iio.accel.x.opt_scale    -1
    setprop ro.iio.accel.z.opt_scale    -1

    #Gyro: X & Z inverted
    setprop ro.iio.anglvel.x.opt_scale  -1
    setprop ro.iio.anglvel.z.opt_scale  -1

    #Magnetometer: X & Z inverted
    setprop ro.iio.magn.x.opt_scale    -1
    setprop ro.iio.magn.z.opt_scale    -1

    #Add audio parameter version
    setprop ro.audio.version YETI_Audio_Parameters_DVT3_20170405

    #restorecon country
    chown system system /country
    chmod 0777 /country
    restorecon_recursive /country

# ----------------- BEGIN MIX-IN DEFINITIONS -----------------
# Mix-In definitions are auto-generated by mixin-update
##############################################################
# Source: device/intel/mixins/groups/disk-bus/mmc-cht/init.rc
##############################################################
on init
    # Android creates by-name disk links with the disk controller
    # in the generated path, so that the names pulled out of the GPT
    # can be associated with the correct disk. Create a shortcut to
    # /dev/block/by-name so that we can use the same fstabs everywhere.
    mkdir /dev/block 0755 root root
    symlink /dev/block/platform/pci0000:00/80860F14:00/by-name /dev/block/by-name

##############################################################
# Source: device/intel/mixins/groups/boot-arch/efi/init.rc
##############################################################
on fs
    # ro.boot.hardware = TARGET_PRODUCT (set in kernel command line
    # as androidboot.hardware). Mount all the filesystems as specified
    # in the fstab.
    mount_all /fstab.${ro.hardware}

service watchdogd /sbin/watchdogd 10 30
    user root
    class core
    oneshot
    seclabel u:r:watchdogd:s0

on charger
    start watchdogd

on init
   # Load persistent dm-verity state and detect if a restart was
   # triggered after dm-verity detected a corrupted block
   verity_load_state

on early-boot
     chmod 0440 /sys/firmware/dmi/entries/148-0/raw
     chmod 0440 /sys/firmware/dmi/entries/0-0/raw

on fs
   # Update dm-verity persistent state and set partition.*.verified
   # properties
   verity_update_state

on verity-logging
    exec u:r:slideshow:s0 -- /sbin/slideshow -t 30000 -p warning/verity_red_1 warning/verity_red_2
##############################################################
# Source: device/intel/mixins/groups/config-partition/true/init.rc
##############################################################
# Enable SELinux labeling
on post-fs
    restorecon_recursive /oem_config
##############################################################
# Source: device/intel/mixins/groups/wlan/bcm4356/init.rc.1
##############################################################
on charger
    insmod ${ro.boot.moduleslocation}/cfg80211.ko
    insmod ${ro.boot.moduleslocation}/bcmdhd_pcie.ko firmware_path=/system/vendor/firmware/brcm/fw_bcmdhd_4356a2_pcie.bin nvram_path=/system/vendor/firmware/brcm/nvram_pcie_4356_a2.cal

on post-fs-data
    start wlan_prov
    wait /oem_config/wifi/mac.txt
    copy /system/vendor/firmware/brcm/nvram_pcie_4356_a2.cal /oem_config/wifi_config/nvram_pcie_4356_a2.cal
    chown system system /oem_config/wifi_config/nvram_pcie_4356_a2.cal
    chmod 0666 /oem_config/wifi_config/nvram_pcie_4356_a2.cal
    insmod ${ro.boot.moduleslocation}/cfg80211.ko
    insmod ${ro.boot.moduleslocation}/bcmdhd_pcie.ko firmware_path=/system/vendor/firmware/brcm/fw_bcmdhd_4356a2_pcie.bin nvram_path=/oem_config/wifi_config/nvram_pcie_4356_a2.cal
    wait /sys/class/net/wlan0/queues/rx-0/rps_cpus 1
    write /sys/class/net/wlan0/queues/rx-0/rps_cpus F
    write /sys/devices/pci0000:00/0000:00:1c.0/0000:01:00.0/enable 1
    write /sys/devices/pci0000:00/0000:00:1c.0/0000:01:00.0/enable 0
##############################################################
# Source: device/intel/mixins/groups/wlan/bcm4356/init.rc
##############################################################
on post-fs
    # group wifi for wpa_supplicant access
    mkdir /oem_config/wifi 0770 system wifi
    mkdir /oem_config/bt 0770 system wifi
    mkdir /oem_config/wifi_config 0770 system wifi

service wlan_prov /system/vendor/bin/wlan_prov
    class main
    user system
    group system wifi
    disabled
    oneshot

service wpa_supplicant /system/bin/wpa_supplicant \
    -iwlan0 -Dnl80211 -c/data/misc/wifi/wpa_supplicant.conf \
    -I/system/etc/wifi/wpa_supplicant_overlay.conf \
    -O/data/misc/wifi/sockets \
    -e/data/misc/wifi/entropy.bin -g@android:wpa_wlan0
    # we will start as root and wpa_supplicant will switch to user wifi
    # after setting up the capabilities required for WEXT
    # user wifi
    # group wifi inet keystore
    class main
    socket wpa_wlan0 dgram 660 wifi wifi
    disabled
    oneshot

service p2p_supplicant /system/bin/wpa_supplicant \
   -iwlan0 -Dnl80211 -c/data/misc/wifi/wpa_supplicant.conf \
   -I/system/etc/wifi/wpa_supplicant_overlay.conf \
   -m/data/misc/wifi/p2p_supplicant.conf \
   -puse_p2p_group_interface=1p2p_device=1use_multi_chan_concurrent=1 \
   -O/data/misc/wifi/sockets \
   -e/data/misc/wifi/entropy.bin \
   -d -g@android:wpa_wlan0
    class main
    socket wpa_wlan0 dgram 660 wifi wifi
    disabled
    oneshot

service dhcpcd_wlan0 /system/bin/dhcpcd -aABDKL
    class main
    disabled
    oneshot

service iprenew_wlan0 /system/bin/dhcpcd -n
    class main
    disabled
    oneshot

service dhcpcd_p2p /system/bin/dhcpcd -aABKL
    class main
    group wifi system dhcp
    disabled
    oneshot

service iprenew_p2p /system/bin/dhcpcd -n
    class main
    group wifi system dhcp
    disabled
    oneshot
##############################################################
# Source: device/intel/mixins/groups/kernel/gmin64/init.rc
##############################################################
on boot
	write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor interactive
	write /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor interactive
	write /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor interactive
	write /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor interactive
	chown system system /sys/devices/system/cpu/cpufreq/interactive/touchboostpulse

	chown system system /sys/devices/system/cpu/cpufreq/interactive/timer_rate
	chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/timer_rate
	chown system system /sys/devices/system/cpu/cpufreq/interactive/timer_slack
	chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/timer_slack
	chown system system /sys/devices/system/cpu/cpufreq/interactive/min_sample_time
	chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/min_sample_time
	chown system system /sys/devices/system/cpu/cpufreq/interactive/hispeed_freq
	chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/hispeed_freq
	chown system system /sys/devices/system/cpu/cpufreq/interactive/target_loads
	chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/target_loads
	chown system system /sys/devices/system/cpu/cpufreq/interactive/go_hispeed_load
	chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/go_hispeed_load
	chown system system /sys/devices/system/cpu/cpufreq/interactive/above_hispeed_delay
	chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/above_hispeed_delay
	chown system system /sys/devices/system/cpu/cpufreq/interactive/boost
	chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/boost
	chown system system /sys/devices/system/cpu/cpufreq/interactive/boostpulse
	chown system system /sys/devices/system/cpu/cpufreq/interactive/input_boost
	chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/input_boost
	chown system system /sys/devices/system/cpu/cpufreq/interactive/boostpulse_duration
	chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/boostpulse_duration
	chown system system /sys/devices/system/cpu/cpufreq/interactive/io_is_busy
	chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/io_is_busy
	# Assume SMP uses shared cpufreq policy for all CPUs
	chown system system /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
	chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq

on property:sys.boot_completed=1
	write /sys/devices/system/cpu/cpufreq/interactive/boost 0
	write /sys/devices/system/cpu/cpufreq/interactive/irq_load_threshold 2
        start lenovo_sn

##############################################################
# Source: device/intel/mixins/groups/houdini/true/init.rc
##############################################################
# Enable native bridge for target executables
on early-init
    mount binfmt_misc binfmt_misc /proc/sys/fs/binfmt_misc

on property:ro.enable.native.bridge.exec=1
    copy /system/vendor/etc/binfmt_misc/arm_exe /proc/sys/fs/binfmt_misc/register
    copy /system/vendor/etc/binfmt_misc/arm_dyn /proc/sys/fs/binfmt_misc/register

on property:ro.enable.native.bridge.exec64=1
    copy /system/vendor/etc/binfmt_misc/arm64_exe /proc/sys/fs/binfmt_misc/register
    copy /system/vendor/etc/binfmt_misc/arm64_dyn /proc/sys/fs/binfmt_misc/register
##############################################################
# Source: device/intel/mixins/groups/bugreport/default/init.rc
##############################################################
# bugreport is triggered by holding down volume down, volume up and power
service bugreport /system/bin/dumpstate -d -p -B \
        -o /data/user_de/0/com.android.shell/files/bugreports/bugreport
    class main
    disabled
    oneshot
    keycodes 114 115 116
##############################################################
# Source: device/intel/mixins/groups/graphics/ufo_gen8/init.rc.1
##############################################################
# Allow the Gfx PCI device(0000:02:00) to go into D0ix states through runtime pm
on boot
	write /sys/devices/pci0000\:00/0000\:00\:02.0/power/control auto

on charger
    write /sys/devices/pci0000\:00/0000\:00\:02.0/power/control auto

##############################################################
# Source: device/intel/mixins/groups/graphics/ufo_gen8/init.rc
##############################################################
# for hardware accelerated graphics
service msync /system/vendor/bin/msync
    class main
    user media
    group media

service coreu /system/vendor/bin/coreu
    class main
    user media
    group media shell

on post-fs-data
    # Change ownership of pci syfs file to 'media', as hdcpd runs as 'media'
    chown media media /sys/devices/pci0000\:00/0000\:00\:02.0/resource0
    mkdir /data/system 0770 system system
    mkdir /data/coreu 0770 media root
    chown media media /data/coreu/coreu

on boot
    #Give permission to system to use i915_videostatus sysfs interface
    chown system system /sys/class/drm/card0/power/i915_videostatus
    chown media media /sys/kernel/debug/tracing/events/drm/drm_vblank_event/enable
    chown media media /sys/kernel/debug/tracing/events/i915/i915_flip_complete/enable
    chown media media /sys/kernel/debug/tracing/events/i915/i915_flip_request/enable
    chown media media /sys/kernel/debug/tracing/events/i915/i915_gem_ring_dispatch/enable
    chown media media /sys/kernel/debug/tracing/events/i915/i915_gem_request_complete/enable
    chown media media /sys/kernel/debug/tracing/events/i915/i915_gem_request_retire/enable
    chown media media /sys/kernel/debug/tracing/events/i915/i915_gem_request_wait_begin/enable
    chown media media /sys/kernel/debug/tracing/events/i915/i915_gem_request_wait_end/enable
    chown media media /sys/kernel/debug/tracing/events/i915/i915_ring_wait_begin/enable
    chown media media /sys/kernel/debug/tracing/events/i915/i915_ring_wait_end/enable
    chown media media /sys/devices/pci0000:00/0000:00:02.0/drm/card0/gt_max_freq_mhz
    chown media media /sys/devices/pci0000:00/0000:00:02.0/drm/card0/gt_min_freq_mhz

on property:persist.gen_gfxd.enable=1
    start gfxd

on property:persist.gen_gfxd.enable=0
    stop gfxd

service gfxd /system/vendor/bin/gfxd
    class main
    user root
    group graphics
    disabled
##############################################################
# Source: device/intel/mixins/groups/storage/sdcard-mmcblk1-4xUSB-sda-emulated/init.rc
##############################################################
on init
    # Support legacy paths
    symlink /sdcard /mnt/sdcard
    symlink /sdcard /storage/sdcard0

##############################################################
# Source: device/intel/mixins/groups/ethernet/dhcp/init.rc
##############################################################

service dhcpcd_eth0 /system/bin/dhcpcd -ABDKL
     class main
     disabled
     oneshot

service iprenew_eth0 /system/bin/dhcpcd -n
     class main
     disabled
     oneshot
##############################################################
# Source: device/intel/mixins/groups/rfkill/true/init.rc
##############################################################
on boot
    insmod ${ro.boot.moduleslocation}/rfkill-gpio.ko
    start rfkill-init

service rfkill-init /system/bin/rfkill-init.sh gps
    disabled
    user system
    group system
    oneshot
##############################################################
# Source: device/intel/mixins/groups/bluetooth/bcm4356/init.rc
##############################################################
########################################################
#  BLUETOOTH CONFIGURATION - BROADCOM SPECIFIC
########################################################
on boot
    insmod ${ro.boot.moduleslocation}/bt_lpm.ko
    start rfkill_bt

on post-fs
    mkdir /oem_config/bluetooth
    chown system bluetooth /oem_config/bt
    chmod 0770 /oem_config/bt
    start bd_prov

on early-boot
    chmod 0644 /oem_config/bt/bd_addr.conf
    setprop ro.bt.bdaddr_path "/oem_config/bt/bd_addr.conf"

service rfkill_bt /system/bin/rfkill_bt.sh
    class core
    user root
    oneshot

service dhcpcd_bt-pan /system/bin/dhcpcd -ABKL
    class main
    group bluetooth wifi system dhcp
    disabled
    oneshot

service iprenew_bt-pan /system/bin/dhcpcd -n
    group bluetooth system dhcp
    disabled
    oneshot

service bd_prov /system/bin/bd_prov
    class core
    user system
    group system bluetooth
    disabled
    oneshot

##############################################################
# Source: device/intel/mixins/groups/widi/gen/init.rc
##############################################################
# WiDi Source (Transmitter)
on boot
    setprop widi.hdcp.enable true

    # Enable abr by default for widi
    setprop widi.abr.enable true
    setprop widi.setsocketsize.enable false
    setprop widi.socketpriority.enable false



on post-fs-data
    mkdir /data/misc/dnsmasq 0755 root root
    mkdir /data/misc/dnsmasq/dalvik-cache 0755 root root
    restorecon_recursive /data/misc/dnsmasq
##############################################################
# Source: device/intel/mixins/groups/audio/cht/init.rc.1
##############################################################
on boot
    setprop audio.offload.capabilities 1
    setprop audio.offload.min.duration.secs 20
    setprop audio.device.name cherrytrailaud


##############################################################
# Source: device/intel/mixins/groups/audio/cht/init.rc
##############################################################
on boot
    setprop persist.media.pfw.verbose true

##############################################################
# Source: device/intel/mixins/groups/camera/ipu2/init.rc
##############################################################
# The atomisp driver is sensitive to initialization order (it must be
# loaded after the sensor drivers) and does a request_firmware() out
# of the module init function which will deadlock init.

on charger
    insmod ${ro.boot.moduleslocation}/videobuf-core.ko
    insmod ${ro.boot.moduleslocation}/videobuf-vmalloc.ko
    insmod ${ro.boot.moduleslocation}/atomisp-css2401a0_v21.ko skip_fwload=1

on boot
    setprop camera.disable_zsl_mode 1
    insmod ${ro.boot.moduleslocation}/videobuf-core.ko
    insmod ${ro.boot.moduleslocation}/videobuf-vmalloc.ko
    insmod ${ro.boot.moduleslocation}/atomisp-css2401a0_v21.ko dypool_enable=y repool_pgnr=32768 defer_fw_load=1
    wait /dev/video0
##############################################################
# Source: device/intel/mixins/groups/sensors/ish/init.rc
##############################################################
service sensorhubd /system/vendor/bin/sensorhubd
    class main
    user system
    group root
    socket sensorhubd stream 600 system system

service lenovo_sn /system/bin/lenovo_sn
    class main
    user root
    oneshot
    disabled
    seclabel u:r:lenovo_sn:s0

on boot
    insmod ${ro.boot.moduleslocation}/ishtp.ko
    insmod ${ro.boot.moduleslocation}/ish.ko
    insmod ${ro.boot.moduleslocation}/hid-ishtp.ko
    insmod ${ro.boot.moduleslocation}/ish-hid-drv.ko
##############################################################
# Source: device/intel/mixins/groups/usb/host+acc/init.rc
##############################################################
on boot
    write /sys/devices/pci0000\:00/0000\:00\:14.0/power/control auto

on charger
    write /sys/devices/pci0000\:00/0000\:00\:14.0/power/control auto
##############################################################
# Source: device/intel/mixins/groups/usb-gadget/configfs/init.rc
##############################################################
on boot
    mount configfs none /config
    mkdir /config/usb_gadget/g1 0770 shell shell
    write /config/usb_gadget/g1/idVendor 0x17ef
    write /config/usb_gadget/g1/bcdDevice 0x0
    write /config/usb_gadget/g1/bcdUSB 0x310
    mkdir /config/usb_gadget/g1/strings/0x409 0770
    write /config/usb_gadget/g1/strings/0x409/serialnumber ${ro.serialno}
    write /config/usb_gadget/g1/strings/0x409/manufacturer ${ro.product.manufacturer}
    write /config/usb_gadget/g1/strings/0x409/product ${ro.product.model}
    mkdir /config/usb_gadget/g1/functions/ffs.adb
    mkdir /config/usb_gadget/g1/functions/mtp.gs0
    mkdir /config/usb_gadget/g1/functions/mass_storage.gs9
    mkdir /config/usb_gadget/g1/functions/ptp.gs1
    mkdir /config/usb_gadget/g1/functions/accessory.gs2
    mkdir /config/usb_gadget/g1/functions/audio_source.gs3
    mkdir /config/usb_gadget/g1/functions/rndis.gs4
    mkdir /config/usb_gadget/g1/functions/midi.gs5
    mkdir /config/usb_gadget/g1/functions/acm.gs6
    mkdir /config/usb_gadget/g1/functions/acm.gs7
    mkdir /config/usb_gadget/g1/functions/acm.gs8
    write /config/usb_gadget/g1/functions/acm.gs6/string_data at_commands
    write /config/usb_gadget/g1/functions/acm.gs6/protocol_function_iad 0
    write /config/usb_gadget/g1/functions/acm.gs6/protocol_interface_ctrl 0
    write /config/usb_gadget/g1/functions/acm.gs7/string_data oct_trace
    write /config/usb_gadget/g1/functions/acm.gs7/protocol_function_iad 0
    write /config/usb_gadget/g1/functions/acm.gs7/protocol_interface_ctrl 0
    write /config/usb_gadget/g1/functions/acm.gs8/string_data gti_ipicom
    write /config/usb_gadget/g1/functions/acm.gs8/protocol_function_iad 0
    write /config/usb_gadget/g1/functions/acm.gs8/protocol_interface_ctrl 0
    mkdir /config/usb_gadget/g1/configs/b.1 0770 shell shell
    mkdir /config/usb_gadget/g1/configs/b.1/strings/0x409 0770 shell shell
    write /config/usb_gadget/g1/os_desc/b_vendor_code 0x1
    write /config/usb_gadget/g1/os_desc/qw_sign "MSFT100"
    write /config/usb_gadget/g1/configs/b.1/MaxPower 500
    symlink /config/usb_gadget/g1/configs/b.1 /config/usb_gadget/g1/os_desc/b.1
    mkdir /dev/usb-ffs 0770 shell shell
    mkdir /dev/usb-ffs/adb 0770 shell shell
    mount functionfs adb /dev/usb-ffs/adb uid=2000,gid=2000
    setprop sys.usb.configfs 1
    setprop sys.usb.controller dwc3.0.auto

on property:sys.usb.config=none && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/os_desc/use 0
    setprop sys.usb.ffs.ready 0

on property:init.svc.adbd=stopped
    setprop sys.usb.ffs.ready 0

on property:sys.usb.config=mtp && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/functions/mtp.gs0/os_desc/interface.MTP/compatible_id "MTP"
    write /config/usb_gadget/g1/os_desc/use 1
    write /config/usb_gadget/g1/idVendor 0x17EF
    write /config/usb_gadget/g1/idProduct 0x79AD

on property:sys.usb.config=mtp,adb && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/functions/mtp.gs0/os_desc/interface.MTP/compatible_id "MTP"
    write /config/usb_gadget/g1/os_desc/use 1
    write /config/usb_gadget/g1/idVendor 0x17EF
    write /config/usb_gadget/g1/idProduct 0x79AE

on property:sys.usb.config=mtp,mass_storage && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/functions/mass_storage.gs9/os_desc/interface.MTP/compatible_id "MASS_STORAGE"
    write /config/usb_gadget/g1/os_desc/use 1
    write /config/usb_gadget/g1/idVendor 0x17EF
    write /config/usb_gadget/g1/idProduct 0x79AF

on property:sys.usb.config=mtp,mass_storage,adb && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/functions/mass_storage.gs9/os_desc/interface.MTP/compatible_id "MASS_STORAGE"
    write /config/usb_gadget/g1/os_desc/use 1
    write /config/usb_gadget/g1/idVendor 0x17EF
    write /config/usb_gadget/g1/idProduct 0x79B0

on property:sys.usb.config=rndis && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/idVendor 0x17EF
    write /config/usb_gadget/g1/idProduct 0x79B3

on property:sys.usb.config=rndis,adb && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/idVendor 0x17EF
    write /config/usb_gadget/g1/idProduct 0x79B4

on property:sys.usb.config=ptp && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/functions/ptp.gs1/os_desc/interface.MTP/compatible_id "PTP"
    write /config/usb_gadget/g1/os_desc/use 1
    write /config/usb_gadget/g1/idVendor 0x17EF
    write /config/usb_gadget/g1/idProduct 0x79B1

on property:sys.usb.config=ptp,adb && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/functions/ptp.gs1/os_desc/interface.MTP/compatible_id "PTP"
    write /config/usb_gadget/g1/os_desc/use 1
    write /config/usb_gadget/g1/idVendor 0x17EF
    write /config/usb_gadget/g1/idProduct 0x79B2

on property:sys.usb.config=adb && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/idVendor 0x8087
    write /config/usb_gadget/g1/idProduct 0x09ef

on property:sys.usb.config=midi && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/idVendor 0x8087
    write /config/usb_gadget/g1/idProduct 0x0a65

on property:sys.usb.config=midi,adb && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/idVendor 0x8087
    write /config/usb_gadget/g1/idProduct 0x0a67


on property:sys.usb.config=accessory && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/idVendor 0x18d1
    write /config/usb_gadget/g1/idProduct 0x2d00

on property:sys.usb.config=accessory,adb && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/idVendor 0x18d1
    write /config/usb_gadget/g1/idProduct 0x2d01

on property:sys.usb.config=audio_source && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/idVendor 0x18d1
    write /config/usb_gadget/g1/idProduct 0x2d02

on property:sys.usb.config=audio_source,adb && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/idVendor 0x18d1
    write /config/usb_gadget/g1/idProduct 0x2d03

on property:sys.usb.config=accessory,audio_source && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/idVendor 0x18d1
    write /config/usb_gadget/g1/idProduct 0x2d04

on property:sys.usb.config=accessory,audio_source,adb && property:sys.usb.configfs=1
    write /config/usb_gadget/g1/idVendor 0x18d1
    write /config/usb_gadget/g1/idProduct 0x2d05
##############################################################
# Source: device/intel/mixins/groups/midi/true/init.rc
##############################################################
on property:sys.usb.config=midi
    write /sys/class/android_usb/android0/enable 0
    write /sys/class/android_usb/android0/idVendor 8087
    write /sys/class/android_usb/android0/idProduct 0a67
    write /sys/class/android_usb/android0/functions ${sys.usb.config}
    write /sys/class/android_usb/android0/enable 1
    setprop sys.usb.state ${sys.usb.config}

on property:sys.usb.config=midi,adb
    write /sys/class/android_usb/android0/enable 0
    write /sys/class/android_usb/android0/idVendor 8087
    write /sys/class/android_usb/android0/idProduct 0a65
    write /sys/class/android_usb/android0/functions ${sys.usb.config}
    write /sys/class/android_usb/android0/enable 1
    start adbd
    setprop sys.usb.state ${sys.usb.config}
##############################################################
# Source: device/intel/mixins/groups/touch/atmel1000/init.rc
##############################################################
on post-fs
    chown system system /sys/bus/i2c/devices/5-006c/power_HAL_suspend
    chown system system /sys/bus/i2c/devices/1-0014/power_HAL_suspend
##############################################################
# Source: device/intel/mixins/groups/charger/true/init.rc
##############################################################
service charger /charger
    class charger
    seclabel u:r:healthd:s0

##############################################################
# Source: device/intel/mixins/groups/gps/bcm4752/init.rc
##############################################################
on post-fs-data
    # Create data folder for GPS
    mkdir /data/gps 0770 gps system

on boot
    chmod 0660 /sys/class/tty/ttyHSU1/../../power/control
    chown system system /sys/class/tty/ttyHSU1/../../power/control
    mkdir /dev/gps 0770 gps system
    symlink /dev/ttyHSU1 /dev/gps/ttyGPS
    symlink /sys/class/tty/ttyHSU1/../../power/control /dev/gps/ttyGPSPowerControl

service gpsd /system/vendor/bin/gpsd -c /system/vendor/etc/gps.xml
    class late_start
    user gps
    group system inet radio sdcard_rw

##############################################################
# Source: device/intel/mixins/groups/thermal/itux/init.rc
##############################################################
on post-fs
    setprop persist.service.thermal 1
    setprop persist.thermal.mode itux
    setprop persist.thermal.shutdown.msg 1
    setprop persist.thermal.shutdown.vibra 1
    setprop persist.thermal.shutdown.tone 1
    setprop persist.thermal.display.msg 1
    setprop persist.thermal.display.vibra 1
    setprop sys.powerctl.criticalshutdown 0

    # Permissions for Thermal Management
    chown system system /sys/class/mali/pm/max_freq_level
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/thermal_scaling_max_freq
    chown system system /sys/devices/system/cpu/cpu1/cpufreq/thermal_scaling_max_freq
    chown system system /sys/devices/system/cpu/cpu2/cpufreq/thermal_scaling_max_freq
    chown system system /sys/devices/system/cpu/cpu3/cpufreq/thermal_scaling_max_freq
    chmod 0664 /sys/devices/system/cpu/cpu0/cpufreq/thermal_scaling_max_freq
    chmod 0664 /sys/devices/system/cpu/cpu1/cpufreq/thermal_scaling_max_freq
    chmod 0664 /sys/devices/system/cpu/cpu2/cpufreq/thermal_scaling_max_freq
    chmod 0664 /sys/devices/system/cpu/cpu3/cpufreq/thermal_scaling_max_freq
    chmod 0664 /sys/class/mali/pm/max_freq_level

on boot
    chown system system /sys/class/powercap/intel-rapl:0/enabled
    chown system system /sys/class/powercap/intel-rapl:0/constraint_0_power_limit_uw
    restorecon_recursive /sys/class/powercap
service thermal_lite /thermal_lite
    class charger
    seclabel u:r:thermal_lite:s0

on property:sys.powerctl.criticalshutdown=1
    write /sys/class/misc/pmic/vbus_det_type edge


##############################################################
# Source: device/intel/mixins/groups/debug-logs/true/init.rc
##############################################################
import /init.logs.rc
##############################################################
# Source: device/intel/mixins/groups/debug-crashlogd/true/init.rc
##############################################################
import /init.crashlogd.rc
##############################################################
# Source: device/intel/mixins/groups/debug-coredump/true/init.rc
##############################################################
import /init.coredump.rc
##############################################################
# Source: device/intel/mixins/groups/debug-charging/configfs/init.rc
##############################################################
import /init.debug-charging.rc
##############################################################
# Source: device/intel/mixins/groups/debug-mpm/true/init.rc
##############################################################
import /init.diag.rc
##############################################################
# Source: device/intel/mixins/groups/charger-usb/configfs/init.rc
##############################################################
import /init.cos-charging.rc
##############################################################
# Source: device/intel/mixins/groups/power/true/init.rc
##############################################################
on post-fs
    mkdir /dev/cpuset/non_interactive
    write /dev/cpuset/non_interactive/mems 0
    write /dev/cpuset/non_interactive/cpus 0-3
    chown system system /dev/cpuset/non_interactive
    chown system system /dev/cpuset/non_interactive/cpus

    setprop ro.powerhal.cpuset_config """"
on property:sys.power_hal.niproc=*
    write /dev/cpuset/non_interactive/tasks ${sys.power_hal.niproc}

service power_hal_helper /system/vendor/bin/power_hal_helper
    user system
    group system
    disabled
    oneshot

on property:init.svc.media=running
    start power_hal_helper

on post-fs-data
    # Enable by default android java wakelock logging
    setprop wakelock.trace 1
##############################################################
# Source: device/intel/mixins/groups/security/txei/init.rc
##############################################################
on boot
    write /sys/devices/pci0000:00/0000:00:1a.0/power/control auto
on init
    symlink /dev/mei0 /dev/mei

on charger
    write /sys/devices/pci0000:00/0000:00:1a.0/power/control auto
##############################################################
# Source: device/intel/mixins/groups/hw-keystore/txei-km0/init.rc
##############################################################
service keymaster_meid /system/bin/keymaster_meid
    # need to be in core class to be started with vold
    class core
    user keystore
    group keystore drmrpc system wakelock
    socket keymaster_mei stream 0660 keystore drmrpc

##############################################################
# Source: device/intel/mixins/groups/hdcpd/true/init.rc
##############################################################
# Note that this service must start as root to set up a mem-mapped region
# and once that is set up it will drop all unnecessary capabilities and
# will not show up as a root process in the steady state.
service hdcpd /system/vendor/bin/hdcpd
    class main
    user media
    group graphics drmrpc

# mkdir hdcp data folder here, non system service don't have permission
# to write in /data/
on post-fs-data
    mkdir /data/hdcp 0770 media media
##############################################################
# Source: device/intel/mixins/groups/readahead/optimized/init.rc
##############################################################
on property:dev.bootcomplete=1
        #default specified size is 512 
	#Change mmc read ahead size from 128 to specified size to reduce USB MTP read latencies
	#also save power during MP3 playback
	write /sys/block/mmcblk0/queue/read_ahead_kb 512
	#Change mmc encryption read ahead size from 128 to specified size
	write /sys/block/dm-0/queue/read_ahead_kb 512
	write /sys/block/dm-1/queue/read_ahead_kb 512
##############################################################
# Source: device/intel/mixins/groups/intel_prop/true/init.rc
##############################################################
service intel_prop /system/vendor/bin/intel_prop
    user 5002
    group root
    class core
    oneshot
##############################################################
# Source: device/intel/mixins/groups/net/common/init.rc
##############################################################
on boot
    write /proc/sys/net/ipv4/tcp_limit_output_bytes 1500000
    write /proc/sys/net/core/rmem_max 6291456
    write /proc/sys/net/core/wmem_max 4194304

##############################################################
# Source: device/intel/mixins/groups/telephony/tablet_flashless_voice/init.rc.1
##############################################################
# init.rc for telephony services specific to flashless platforms

on init
    # Contains dynamic configuration and calibration data.
    mkdir /oem_config 0770 radio radio

##############################################################
# Source: device/intel/mixins/groups/telephony/tablet_flashless_voice/init.rc
##############################################################
# init.rc for telephony services common to all platforms
on boot

    # change group for IPC interfaces
    chown root system /sys/devices/pci0000:00/0000:00:14.0/power/control
    chmod 0664 /sys/devices/pci0000:00/0000:00:14.0/power/control
    chown root system /sys/devices/pci0000:00/0000:00:14.0/usb2/2-5/power/wakeup
    chmod 0664 /sys/devices/pci0000:00/0000:00:14.0/usb2/2-5/power/wakeup
    chown root system /sys/devices/pci0000:00/0000:00:14.0/ssic_port_enable
    chmod 0664 /sys/devices/pci0000:00/0000:00:14.0/power/ssic_port_enable


    chown root system /sys/bus/usb/devices/2-0:1.0/port5/usb3_lpm
    chmod 0664 /sys/bus/usb/devices/2-0:1.0/port5/usb3_lpm

    # disable HSIC port
    write /sys/bus/usb/devices/1-0:1.0/port6/power/pm_qos_no_power_off 0

on init
    # disable SSIC port
    write /sys/devices/pci0000:00/0000:00:14.0/power/control on
    write /sys/devices/pci0000:00/0000:00:14.0/ssic_port_enable 0
    write /sys/devices/pci0000:00/0000:00:14.0/power/control auto

# USB ACM configuration, with rndis and adb
on property:sys.usb.config=rndis,acm,adb
    start adbd

# ACM will create ttyGS0, ttyGS1, ttyGS2
on property:sys.usb.ffs.ready=1 && property:sys.usb.config=rndis,acm,adb
    write /config/usb_gadget/g1/configs/b.1/strings/0x409/configuration "rndis_acm_adb"
    rm /config/usb_gadget/g1/configs/b.1/f1
    rm /config/usb_gadget/g1/configs/b.1/f2
    rm /config/usb_gadget/g1/configs/b.1/f3
    mkdir /config/usb_gadget/g1/functions/rndis.gs4

    write /config/usb_gadget/g1/idVendor 0x8087
    write /config/usb_gadget/g1/idProduct 0x0a64
    symlink /config/usb_gadget/g1/functions/rndis.gs4 /config/usb_gadget/g1/configs/b.1/f1
    symlink /config/usb_gadget/g1/functions/acm.gs6 /config/usb_gadget/g1/configs/b.1/f2
    symlink /config/usb_gadget/g1/functions/ffs.adb /config/usb_gadget/g1/configs/b.1/f3
    write /config/usb_gadget/g1/UDC ${sys.usb.controller}
    setprop sys.usb.state ${sys.usb.config}
    wait /sys/class/net/rndis0/queues/rx-0/rps_cpus 1
    write /sys/class/net/rndis0/queues/rx-0/rps_cpus F

on property:persist.system.at-proxy.mode=*
    setprop system.at-proxy.mode ${persist.system.at-proxy.mode}


on property:system.at-proxy.mode=0
    stop proxy
    stop proxy-tunneling
    start atproxy_usbreset

on property:system.at-proxy.mode=1
    stop ad_proxy
    stop proxy-tunneling
    setprop sys.usb.config rndis,acm,adb
    start proxy

on property:system.at-proxy.mode=2
    stop ad_proxy
    stop proxy
    setprop sys.usb.config rndis,acm,adb
    start proxy-tunneling

# MTS SERVICES

# mts persistent
service mtsp /system/vendor/bin/mts
    user system
    group radio log media_rw sdcard_r sdcard_rw inet
    disabled

# mts oneshot
service mtso /system/vendor/bin/mts
    user system
    group radio log media_rw sdcard_rw inet
    oneshot
    disabled

# MTS Properties, events trigging service

on property:persist.service.mtsp.enable=1
    start mtsp

on property:persist.service.mtsp.enable=0
    stop mtsp

on property:persist.service.mtso.enable=1
    start mtso

on property:persist.service.mtso.enable=0
    stop mtso

# service used by AMTL to send SIGUSR1 to mts
service pti_sigusr1 /system/vendor/bin/pti_sigusr1
    user system
    oneshot
    disabled

# Activate RPS and disable duplicate address detection
# for usbX devices
on property:sys.usb.modemevt=1
   setprop sys.usb.modemevt 0
   wait /sys/class/net/usb0/queues/rx-0/rps_cpus 1
   write /sys/class/net/usb0/queues/rx-0/rps_cpus F
   wait /sys/class/net/usb1/queues/rx-0/rps_cpus 1
   write /sys/class/net/usb1/queues/rx-0/rps_cpus F
   wait /sys/class/net/usb2/queues/rx-0/rps_cpus 1
   write /sys/class/net/usb2/queues/rx-0/rps_cpus F
   wait /sys/class/net/usb3/queues/rx-0/rps_cpus 1
   write /sys/class/net/usb3/queues/rx-0/rps_cpus F
   wait /sys/class/net/usb4/queues/rx-0/rps_cpus 1
   write /sys/class/net/usb4/queues/rx-0/rps_cpus F

   write /proc/sys/net/ipv6/conf/usb0/accept_dad 0
   write /proc/sys/net/ipv6/conf/usb1/accept_dad 0
   write /proc/sys/net/ipv6/conf/usb2/accept_dad 0
   write /proc/sys/net/ipv6/conf/usb3/accept_dad 0
   write /proc/sys/net/ipv6/conf/usb4/accept_dad 0

   write /proc/sys/net/ipv6/conf/usb0/dad_transmits 0
   write /proc/sys/net/ipv6/conf/usb1/dad_transmits 0
   write /proc/sys/net/ipv6/conf/usb2/dad_transmits 0
   write /proc/sys/net/ipv6/conf/usb3/dad_transmits 0
   write /proc/sys/net/ipv6/conf/usb4/dad_transmits 0

# Activate usage of temporary addresses on cellular IPV6 connections
   write /proc/sys/net/ipv6/conf/usb0/use_tempaddr 2
   write /proc/sys/net/ipv6/conf/usb1/use_tempaddr 2
   write /proc/sys/net/ipv6/conf/usb2/use_tempaddr 2
   write /proc/sys/net/ipv6/conf/usb3/use_tempaddr 2
   write /proc/sys/net/ipv6/conf/usb4/use_tempaddr 2

# Activate RPS and disable duplicate address detection
# for PCIe devices


##############################################################
# Source: device/intel/mixins/groups/efiprop/used/init.rc
##############################################################
on late-init
    mount efivarfs none /sys/firmware/efi/efivars
##############################################################
# Source: device/intel/mixins/groups/factory-partition/true/init.rc
##############################################################
# init.rc for telephony services specific to flashless platforms using /factory partition

on init
# Used as mounting point for factory partition.
# Calibration files configuring IMEI and RF calibration will also be stored on this partition.
    mkdir /factory 0770 system system

on post-fs
    restorecon_recursive /factory
    trigger post-fs-factory
##############################################################
# Source: device/intel/mixins/groups/pstore/ram_pram/init.rc
##############################################################
on fs
    mkdir /dev/pstore 0700 5001 root
    mount pstore pstore /dev/pstore

on post-fs-data
   mkdir /data/dontpanic 0770 root log

   # xj
    #Create socket dir for oskd
    mkdir /data/osk
    mkdir /data/osk/socket
    mkdir /data/osk/lm
    chown root system /data/osk
    chmod 0770 /data/osk
    chown root system /data/osk/socket
    chmod 0770 /data/osk/socket
    chown root system /data/osk/lm
    chmod 0770 /data/osk/lm

service oskd /system/bin/oskd
    class main
    user  root
    group system


service pstore-clean /system/vendor/bin/pstore-clean
    user 5001
    group root log
    class late_start
    oneshot

on property:init.svc.pstore-clean=stopped
    umount /dev/pstore
    rmdir /dev/pstore
##############################################################
# Source: device/intel/mixins/groups/debug-log-watch/true/init.rc
##############################################################
import /init.log-watch.rc

##############################################################
# Source: device/intel/mixins/groups/cpuset/4cores/init.rc
##############################################################
on late-init
    write /dev/cpuset/foreground/cpus 0-3
    write /dev/cpuset/background/cpus 0-3
    write /dev/cpuset/system-background/cpus 0-3
    write /dev/cpuset/top-app/cpus 0-3
    write /dev/cpuset/foreground/boost/cpus 0-3
##############################################################
# Source: device/intel/mixins/groups/chrome/true/init.rc
##############################################################
on post-fs-data
    # Link chrome-command-line file
    symlink /system/etc/chrome-command-line /data/local/chrome-command-line
    chmod 0664 /data/local/chrome-command-line
##############################################################
# Source: device/intel/mixins/groups/debug-kernel/default/init.rc
##############################################################
import /init.kernel.rc
##############################################################
# Source: device/intel/mixins/groups/debugfs/default/init.rc
##############################################################
on early-init
    # Mount debugfs and make it writable so that debuggerd can
    # create stack traces, required with newer kernels
    mount debugfs debugfs /sys/kernel/debug
    chmod 0755 /sys/kernel/debug

on early-boot
    # Needed by surfaceflinger to enable it to open trace_marker
    # on start without file permissions error.
    chmod 0222 /sys/kernel/debug/tracing/trace_marker
    # tracefs is mounted after 1st access to it
    chmod 0755 /sys/kernel/debug/tracing
##############################################################
# Source: device/intel/mixins/groups/disk-encryption/default/init.rc
##############################################################
# This _should_ be the very last thing that happens in
# the device's 'on post-fs-data' sections.  Since we compose
# init scripts from various snippets with mixins, we need to
# ensure this is included last in the mixin-update by listing
# disk-encryption as LAST in the mixin spec file.
on post-fs-data
    setprop vold.post_fs_data_done 1
##############################################################
# Source: device/intel/mixins/groups/vendor_fw_load/default/init.rc
##############################################################
on init
    #create /lib folder if it does not exist
    mkdir /lib
    symlink /system/vendor/firmware /lib/firmware
# ------------------ END MIX-IN DEFINITIONS ------------------
